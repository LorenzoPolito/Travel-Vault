---
import { getCollection } from 'astro:content';
import Base from '../../layouts/Base.astro';

export async function getStaticPaths() {
  const entries = await getCollection('info');
  return entries.map(entry => ({
    params: { slug: entry.id.replace(/\.md$/, '') },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
const base = import.meta.env.BASE_URL;

const displayName = entry.id.split('/').pop()?.replace(/-/g, ' ').replace(/\.md$/, '').replace(/\b\w/g, (l: string) => l.toUpperCase()) || entry.id;
const cat = entry.data.category || entry.data.categoria || '';
---

<Base title={displayName} description={`Guida: ${displayName}`}>
  <section class="section">
    <div class="content-container">
      <div class="breadcrumbs">
        <a href={`${base}/`}>Home</a>
        <span class="separator">/</span>
        <a href={`${base}/guides/`}>Guide</a>
        <span class="separator">/</span>
        <span>{displayName}</span>
      </div>

      <div class="page-header">
        <h1 class="page-title">ðŸ“– {displayName}</h1>
        <div class="page-meta">
          {entry.data.destination && <span class="tag">{entry.data.destination}</span>}
          {cat && <span class="tag tag--info">{cat}</span>}
        </div>
      </div>

      <article class="prose">
        <Content />
      </article>
    </div>
  </section>
</Base>
