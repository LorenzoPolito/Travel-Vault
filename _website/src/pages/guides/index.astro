---
import { getCollection } from 'astro:content';
import Base from '../../layouts/Base.astro';

const infoEntries = await getCollection('info');
const base = import.meta.env.BASE_URL;
---

<Base title="Guide" description="Guide pratiche per i tuoi viaggi">
  <section class="section">
    <div class="container">
      <div class="breadcrumbs">
        <a href={base}>Home</a>
        <span class="separator">/</span>
        <span>Guide</span>
      </div>

      <div class="page-header" style="border: none">
        <h1 class="page-title">ğŸ“– Guide Pratiche</h1>
        <p>{infoEntries.length} guide disponibili</p>
      </div>

      <div class="cards-grid">
        {infoEntries.map((info) => {
          const name = info.id.split('/').pop()?.replace(/-/g, ' ').replace(/\.md$/, '').replace(/\b\w/g, (l: string) => l.toUpperCase()) || info.id;
          const cat = info.data.category || info.data.categoria || '';
          const emoji = cat.includes('trasport') || cat.includes('ic-card') ? 'ğŸš„' :
                        cat.includes('sicur') || cat.includes('safety') ? 'ğŸ›¡ï¸' :
                        cat.includes('vol') ? 'âœˆï¸' :
                        cat.includes('sim') ? 'ğŸ“±' :
                        cat.includes('pass') ? 'ğŸ«' : 'ğŸ“–';

          return (
            <a href={`${base}guides/${info.id.replace(/\.md$/, '')}/`} class="card animate-in" style="text-decoration: none">
              <div class="card-emoji">{emoji}</div>
              <h3 class="card-title">{name}</h3>
              <div class="card-meta">
                {info.data.destination && <span class="tag">{info.data.destination}</span>}
                {cat && <span class="tag tag--info">{cat}</span>}
              </div>
            </a>
          );
        })}
      </div>
    </div>
  </section>
</Base>
