---
import { getCollection } from 'astro:content';
import Base from '../../layouts/Base.astro';

export async function getStaticPaths() {
  const entries = await getCollection('itineraries');
  return entries.map(entry => ({
    params: { slug: entry.id.replace(/\.md$/, '') },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
const base = import.meta.env.BASE_URL;

const displayName = entry.id.split('/').pop()?.replace(/-/g, ' ').replace(/\.md$/, '').replace(/\b\w/g, (l: string) => l.toUpperCase()) || entry.id;
---

<Base title={displayName} description={`Itinerario: ${displayName}`}>
  <section class="section">
    <div class="content-container">
      <div class="breadcrumbs">
        <a href={`${base}/`}>Home</a>
        <span class="separator">/</span>
        <a href={`${base}/itineraries/`}>Itinerari</a>
        <span class="separator">/</span>
        <span>{displayName}</span>
      </div>

      <div class="page-header">
        <h1 class="page-title">ğŸ—ºï¸ {displayName}</h1>
        <div class="page-meta">
          {entry.data.destination && <span class="tag">{entry.data.destination}</span>}
          {entry.data.durata && <span class="tag tag--info">{entry.data.durata}</span>}
          {entry.data.durata_giorni && <span class="tag tag--info">{entry.data.durata_giorni} giorni</span>}
          {entry.data.status && <span class="tag tag--success">{entry.data.status}</span>}
          {entry.data.autori && entry.data.autori.length > 0 && (
            <span class="tag">ğŸ‘¥ {entry.data.autori.join(', ')}</span>
          )}
        </div>
      </div>

      <article class="prose">
        <Content />
      </article>
    </div>
  </section>
</Base>
